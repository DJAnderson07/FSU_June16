<!DOCTYPE html>
<html>
<head>
  <title>Plotting w/Base</title>
  <meta charset="utf-8">
  <meta name="description" content="Plotting w/Base">
  <meta name="author" content="Daniel Anderson">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/zenburn.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  
  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>Plotting w/Base</h1>
    <h2>Day 1: Afternoon, Session 1</h2>
    <p>Daniel Anderson<br/>R Training: Florida State University, June 21, 2016</p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:;">
  <article data-timings="">
    <style>
em {
  font-style: italic
}
</style>

<style>
strong {
  font-weight: bold;
}
</style>

<h2>Afternoon Agenda</h2>

<h1>Plotting basics with Base</h1>

<ul>
<li>Histograms and density plots</li>
<li>Scatter plots

<ul>
<li>Controls: 

<ul>
<li>titles</li>
<li>line width, color, and type</li>
<li>point size, color, and type</li>
<li>x and y axis labels</li>
</ul></li>
</ul></li>
<li>Some good non-<em>ggplot2</em> packages</li>
</ul>

<p><span style="color:blue">Break </span></p>

<ul>
<li>Quick note on lists</li>
<li>Complete applied example</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>Data: Beer!</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="../assets/img/beer.jpg" alt="beer"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Load data</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">d &lt;- read.delim(&quot;./data/ratebeer_beerjobber.txt&quot;)
head(d)
</code></pre>

<pre><code>##                                  name                 brewer
## 1                     Abbey Monks Ale Abbey Beverage Company
## 2                  Abbey Monks Tripel Abbey Beverage Company
## 3                     Abbey Monks Wit Abbey Beverage Company
## 4 Alameda Barn Owl Imperial Brown Ale    Alameda Brewing Co.
## 5         Alameda Black Bear XX Stout    Alameda Brewing Co.
## 6       Alameda El Torero Organic IPA    Alameda Brewing Co.
##                     style abv ratings score.overall score.by.style
## 1             Belgian Ale 5.2      96            50             49
## 2            Abbey Tripel 8.0       3            NA             NA
## 3 Belgian White (Witbier) 5.1      46            23             19
## 4               Brown Ale 7.9      13            74             81
## 5           Foreign Stout 6.8     172            94             76
## 6    India Pale Ale (IPA) 7.2      56            74             43
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Histograms</h2>
  </hgroup>
  <article data-timings="">
    <p>Primary purpose of a histogram: See the distrbution of a variable</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">hist(d$abv)
</code></pre>

<p><img src="assets/fig/abvHist-1.png" alt="plot of chunk abvHist"></p>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">hist(d$ratings)
</code></pre>

<p><img src="assets/fig/ratingsHist-1.png" alt="plot of chunk ratingsHist"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-5" style="background:;">
  <hgroup>
    <h2>Look at the documentation</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">?hist
</code></pre>

<p><img src="../assets/img/histDocumentation.png" alt="hist"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-6" style="background:;">
  <hgroup>
    <h2>Change the number of break points</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <pre><code class="r">hist(d$ratings, breaks = 35)
</code></pre>

<p><img src="assets/fig/histBreaks35-1.png" alt="plot of chunk histBreaks35"></p>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">hist(d$ratings, breaks = 100)
</code></pre>

<p><img src="assets/fig/histBreaks100-1.png" alt="plot of chunk histBreaks100"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Alternative: Plot a table of frequencies</h2>
  </hgroup>
  <article data-timings="">
    <h1>(no binning)</h1>

<pre><code class="r">rTbl &lt;- table(d$ratings)
plot(rTbl)
</code></pre>

<p><img src="assets/fig/plotTable-1.png" alt="plot of chunk plotTable"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:;">
  <hgroup>
    <h2>Smooth the distribution</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <h1>Standard Histogram</h1>

<pre><code class="r">hist(d$abv)
</code></pre>

<p><img src="assets/fig/hist-1.png" alt="plot of chunk hist"></p>

</div>
<div style='float:right;width:48%;'>
  <h1>Density Plots</h1>

<pre><code class="r">dens &lt;- density(d$abv); plot(dens)
</code></pre>

<p><img src="assets/fig/dens1-1.png" alt="plot of chunk dens1"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Density binwidth</h2>
  </hgroup>
  <article data-timings="">
    <p>Change the binwidth to control the smoothing factor. The smaller the binwidth,
  the closer the function will resemble the observed data. The larger the 
  binwidth, the closer the function will resemble a standard normal.</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">dens1 &lt;- density(d$abv, bw = .001)
plot(dens1)
</code></pre>

<p><img src="assets/fig/dens2-1.png" alt="plot of chunk dens2"></p>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">dens2 &lt;- density(d$abv, bw = 100)
plot(dens2)
</code></pre>

<p><img src="assets/fig/dens3-1.png" alt="plot of chunk dens3"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-10" style="background:;">
  <hgroup>
    <h2>Your turn</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Load the beer dataset</li>
<li>Produce a histogram</li>
<li>Produce a density plot</li>
<li>Change the number of breaks and the binwidth of each</li>
<li>Try adding the additional argument <code>probability = TRUE</code> to a histogram. What
do you notice?</li>
<li>After producing a histogram with <code>probability = TRUE</code>, try running 
<code>lines(dens)</code> where dens is the density of the vector you produced the histogram from. What do you get?</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>Scatter plots and controlling lines, colors, axes, etc.</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="assets/fig/scatterBoot-1.png" alt="plot of chunk scatterBoot"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>The <code>plot()</code> function</h2>
  </hgroup>
  <article data-timings="">
    <p>Generic x-y plotting. Multiple types of plots are possible. From the 
  documentation:
<img src="../assets/img/plotTypesDocumentation.png" alt="plotTypesDocumentation"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>Plot types</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p><img src="assets/fig/plotTypes1-1.png" alt="plot of chunk plotTypes1"></p>

</div>
<div style='float:right;width:48%;'>
  <p><img src="assets/fig/plotTypes2-1.png" alt="plot of chunk plotTypes2"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Scatter plots</h2>
  </hgroup>
  <article data-timings="">
    <p>Two specifications</p>

<pre><code class="r">plot(outcome ~ predictor, data = d) # Just like the lm function
plot(x-variable, y-variable)
</code></pre>

<h1>Examples</h1>

<div style='float:left;width:48%;'>
  <pre><code class="r">plot(score.overall ~ abv, data = d)
</code></pre>

<p><img src="assets/fig/scatterEx1-1.png" alt="plot of chunk scatterEx1"></p>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">plot(d$abv, d$score.overall)
</code></pre>

<p><img src="assets/fig/scatterEx2-1.png" alt="plot of chunk scatterEx2"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15" style="background:;">
  <hgroup>
    <h2>Additional arguments</h2>
  </hgroup>
  <article data-timings="">
    <table><thead>
<tr>
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead><tbody>
<tr>
<td align="left">main</td>
<td align="left">Main title of the Plot</td>
</tr>
<tr>
<td align="left">sub</td>
<td align="left">Subtitle, added at the bottom of the plot</td>
</tr>
<tr>
<td align="left">xlab</td>
<td align="left">x-axis label</td>
</tr>
<tr>
<td align="left">ylab</td>
<td align="left">y-axis lable</td>
</tr>
<tr>
<td align="left">col</td>
<td align="left">Color (can be multiple things, depending on call)</td>
</tr>
<tr>
<td align="left">pch</td>
<td align="left">Point type</td>
</tr>
<tr>
<td align="left">xlim</td>
<td align="left">Limits of x-axis (vector of length 2)</td>
</tr>
<tr>
<td align="left">ylim</td>
<td align="left">Limits of y-axis (vector of length 2)</td>
</tr>
<tr>
<td align="left">bg</td>
<td align="left">Background color (can be multiple things, depending on call)</td>
</tr>
<tr>
<td align="left">cex</td>
<td align="left">Size of points</td>
</tr>
<tr>
<td align="left">cex.SPEC</td>
<td align="left">Specific call to axis/lab/main/sub to change size of those SPEC (specifications)</td>
</tr>
<tr>
<td align="left">col.SPEC</td>
<td align="left">Color specific calls</td>
</tr>
</tbody></table>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Examples: Beer style and overall ratings</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <h1>Standard Plot</h1>

<pre><code class="r">plot(d$score.by.style, d$score.overall)
</code></pre>

<p><img src="assets/fig/scatterStyleOverall-1.png" alt="plot of chunk scatterStyleOverall"></p>

</div>
<div style='float:right;width:48%;'>
  <h1>Change axes labels, provide title</h1>

<pre><code class="r">plot(d$score.by.style, d$score.overall,
  main = &quot;Relation Between Style Rating and Overall Rating&quot;,
  xlab = &quot;Beer Style Rating&quot;,
  ylab = &quot;Overall Beer Rating&quot;)
</code></pre>

<p><img src="assets/fig/axesTitle-1.png" alt="plot of chunk axesTitle"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>Change point type, color, and size</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <pre><code class="r">plot(d$score.by.style, d$score.overall,
  main = &quot;Relation Between Style 
    Rating and Overall Rating&quot;,
  xlab = &quot;Beer Style Rating&quot;,
  ylab = &quot;Overall Beer Rating&quot;,
  pch = 3,
  cex = 2,
  col = &quot;purple&quot;)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="assets/fig/pointCharacteristics2-1.png" alt="plot of chunk pointCharacteristics2"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Colors in R</h2>
  </hgroup>
  <article data-timings="">
    <div align = "left">
<img src = ../assets/img/rColorExample.png width = 800 height = 800>
</div>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Some helpful packages</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><em>RColorBrewer</em> has some really nice pallets</li>
<li><em>dichromat</em> is useful for creating color schemes that are color-blind friendly</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>Point Types</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">plot(1:20, 1:20, pch = 1:20, cex = 3)
</code></pre>

<p><img src="assets/fig/pointTypes-1.png" alt="plot of chunk pointTypes"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>Line types</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">plot(1:6, 1:6, type = &quot;n&quot;)
for(i in 1:6) abline(i, 0, lty = i, lwd = 3)
</code></pre>

<p><img src="assets/fig/lineTypes-1.png" alt="plot of chunk lineTypes"></p>

<p>Change the line type with <code>lty</code> and the line width with <code>lwd</code>.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>Custom line types</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">plot(1:5, 1:5, type = &quot;n&quot;)
customTypes &lt;- c(&quot;15&quot;, &quot;51&quot;, &quot;4341&quot;, &quot;8138&quot;, &quot;925229&quot;)
for(i in 1:5) abline(i, 0, lty = customTypes[i], lwd = 2)
</code></pre>

<p><img src="assets/fig/customlty-1.png" alt="plot of chunk customlty"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>Add horizontal and vertical reference lines at the mean</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">plot(d$score.by.style, d$score.overall,
  main = &quot;Relation Between Style Rating and Overall Rating&quot;,
  xlab = &quot;Beer Style Rating&quot;,
  ylab = &quot;Overall Beer Rating&quot;,
  pch = 3,
  cex = 2,
  col = &quot;purple&quot;)

abline(h = mean(d$score.overall, na.rm = TRUE), col = &quot;red&quot;, lty = 2, lwd = 3)
abline(v = mean(d$score.by.style, na.rm = TRUE), col = &quot;red&quot;, lty = 2, lwd = 3)
</code></pre>

<p>Plot on next slide</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-24" style="background:;">
  <article data-timings="">
    <p><img src="assets/fig/refLines2-1.png" alt="plot of chunk refLines2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>Quick aside: Fitting linear regression models in R</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">?lm
</code></pre>

<p><img src="../assets/img/lmDocumentation.png" alt="lmDocumentation"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Formula structure</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">lm(outcome ~ predictor1 + predictor2 + predictorN)
</code></pre>

<p>Note that the above has an implicit intercept specification. It can be
  explicit by</p>

<pre><code class="r">lm(outcome ~ 1 + predictor1 + predictor2 + predictorN)
</code></pre>

<p>You can also suppress the estimation of the intercept</p>

<pre><code class="r">lm(outcome ~ 0 + predictor1 + predictor2 + predictorN)
</code></pre>

<h1>Important additional arguments</h1>

<ul>
<li><code>data</code>: What data frame do the vectors come from?</li>
<li><code>subset</code>: Do you want to analyze only a subset of cases?</li>
<li><code>na.action</code>: How should missing values be handled?</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Modeling the relation between beer style rating and the overall rating</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">m1 &lt;- lm(score.overall ~ score.by.style, data = d)
summary(m1)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = score.overall ~ score.by.style, data = d)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -66.04 -16.12   3.77  14.14  40.84 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     32.5671     2.4949   13.05   &lt;2e-16 ***
## score.by.style   0.5468     0.0375   14.58   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.28 on 365 degrees of freedom
##   (33 observations deleted due to missingness)
## Multiple R-squared:  0.368,  Adjusted R-squared:  0.3663 
## F-statistic: 212.6 on 1 and 365 DF,  p-value: &lt; 2.2e-16
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>Alternative summary</h2>
  </hgroup>
  <article data-timings="">
    <p>The <code>arm</code> package (applied regression modeling) provides a lot of useful 
  functions. One simple one is just a different method for showing the summary 
  of a regression model, using the <code>display()</code> function.</p>

<pre><code class="r">install.packages(&quot;arm&quot;)
library(arm)
display(m1, detail = TRUE)
</code></pre>

<pre><code>## Loading required package: MASS
</code></pre>

<pre><code>## Loading required package: Matrix
</code></pre>

<pre><code>## Loading required package: lme4
</code></pre>

<pre><code>## 
## arm (Version 1.8-6, built: 2015-7-7)
</code></pre>

<pre><code>## Working directory is /Users/Daniel/Dropbox/Teaching/FSU_June16
</code></pre>

<pre><code>## lm(formula = score.overall ~ score.by.style, data = d)
##                coef.est coef.se t value Pr(&gt;|t|)
## (Intercept)    32.57     2.49   13.05    0.00   
## score.by.style  0.55     0.04   14.58    0.00   
## ---
## n = 367, k = 2
## residual sd = 19.28, R-Squared = 0.37
</code></pre>

<ul>
<li>Note that significance is not printed by default. Use <code>detail = TRUE</code> to get 
significance test.</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-29" style="background:;">
  <hgroup>
    <h2>Extensions</h2>
  </hgroup>
  <article data-timings="">
    <p>Use the <code>coef()</code> function to extract coefficients</p>

<pre><code class="r">coef(m1)
</code></pre>

<pre><code>##    (Intercept) score.by.style 
##     32.5670460      0.5467723
</code></pre>

<p>Use the <code>predict</code> function to use the model for predictions with new data</p>

<pre><code class="r">predict(m1, newdata = data.frame(score.by.style = seq(80, 100, 1)))
</code></pre>

<pre><code>##        1        2        3        4        5        6        7        8 
## 76.30883 76.85561 77.40238 77.94915 78.49592 79.04270 79.58947 80.13624 
##        9       10       11       12       13       14       15       16 
## 80.68301 81.22978 81.77656 82.32333 82.87010 83.41687 83.96365 84.51042 
##       17       18       19       20       21 
## 85.05719 85.60396 86.15074 86.69751 87.24428
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>Plot the relation and the model</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Two step process: First plot the relation, then overlay the regression line.</li>
</ul>

<div style='float:left;width:48%;'>
  <pre><code class="r">plot(d$score.by.style, d$score.overall,
  main = &quot;Relation Between Style 
    Rating and Overall Rating&quot;,
  xlab = &quot;Beer Style Rating&quot;,
  ylab = &quot;Overall Beer Rating&quot;,
  pch = 3,
  cex = 2,
  col = &quot;purple&quot;)

abline(m1, 
  lty = 3, 
  lwd = 5, 
  col = &quot;aquamarine3&quot;)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="assets/fig/plotRegLines2-1.png" alt="plot of chunk plotRegLines2"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>A note on <code>abline</code></h2>
  </hgroup>
  <article data-timings="">
    <p>All of the following specifications are identical (see the documentation).</p>

<pre><code class="r">abline(m1)
abline(a = coef(m1)[1], b = coef(m1)[2])
abline(coef(m1)[&quot;(Intercept)&quot;], coef(m1)[&quot;score.by.style&quot;])
abline(coef(m1))
</code></pre>

<p><img src="../assets/img/ablineDoc.png" alt="ablineDoc"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>Fit a nonlinear model</h2>
  </hgroup>
  <article data-timings="">
    <p>Simulate some data with a nonlinear relation</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">set.seed(100) # for reproducibility
b0 &lt;- 180
b1 &lt;- 2
b2 &lt;- -0.15

x &lt;- sample(seq(0, 8, 0.1), 25)

y &lt;- b0 + b1*x + b2*(x^2) + 
        rnorm(length(x), 0, 1)
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">plot(x, y)
</code></pre>

<p><img src="assets/fig/nonLinearSimRelation-1.png" alt="plot of chunk nonLinearSimRelation"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h2>Fit the model</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">m2a &lt;- lm(y ~ x + I(x^2))

# Equivalent, but with Orthogonal polynomials
m2b &lt;- lm(y ~ poly(x, 2))

# Or, using the poly function with non-orthogonal polynomials (same as m2a)
m2c &lt;- lm(y ~ poly(x, 2, raw = TRUE))
display(m2c)
</code></pre>

<pre><code>## lm(formula = y ~ poly(x, 2, raw = TRUE))
##                         coef.est coef.se
## (Intercept)             180.61     0.76 
## poly(x, 2, raw = TRUE)1   1.82     0.41 
## poly(x, 2, raw = TRUE)2  -0.14     0.05 
## ---
## n = 25, k = 3
## residual sd = 0.96, R-Squared = 0.74
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-34" style="background:;">
  <hgroup>
    <h2>Overlay the regression line</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">plot(x, y)
xAxis &lt;- seq(-1, 9, 0.1)
preds &lt;- predict(m2c, newdata = data.frame(x = xAxis))
lines(seq(-1, 9, 0.1), preds, col = &quot;blue&quot;, lwd = 2)
</code></pre>

<p><img src="assets/fig/regLineOverlay1-1.png" alt="plot of chunk regLineOverlay1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>Include the SE</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">preds &lt;- predict(m2c, newdata = data.frame(x = xAxis), se = TRUE)
str(preds)
</code></pre>

<pre><code>## List of 4
##  $ fit           : Named num [1:101] 179 179 179 179 179 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:101] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ se.fit        : Named num [1:101] 1.19 1.14 1.1 1.05 1.01 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:101] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ df            : int 22
##  $ residual.scale: num 0.955
</code></pre>

<pre><code class="r">plot(x, y)
lines(xAxis, preds$fit, col = &quot;blue&quot;, lwd = 2)
lines(xAxis, preds$fit - 2*preds$se.fit, col = &quot;red&quot;, lty = 2, 
    lwd = 2)
lines(xAxis, preds$fit + 2*preds$se.fit, col = &quot;red&quot;, lty = 2, 
    lwd = 2)
</code></pre>

<p>Figure on the next slide</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-36" style="background:;">
  <article data-timings="">
    <p><img src="assets/fig/regLineOverlay3-1.png" alt="plot of chunk regLineOverlay3"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>Plot a few different fits</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">lfit025 &lt;- loess(y ~ x, span = 0.25)
lfit050 &lt;- loess(y ~ x, span = 0.50)
lfit075 &lt;- loess(y ~ x, span = 0.75)
lfit100 &lt;- loess(y ~ x, span = 1.00)
plot(y ~ x)
lines(xAxis, predict(lfit025, newdata = data.frame(x = xAxis)), 
  col = &quot;red&quot;, lwd = 2)
lines(xAxis, predict(lfit050, newdata = data.frame(x = xAxis)), 
  col = &quot;green&quot;, lwd = 2)
lines(xAxis, predict(lfit075, newdata = data.frame(x = xAxis)), 
  col = &quot;blue&quot;, lwd = 2)
lines(xAxis, predict(lfit100, newdata = data.frame(x = xAxis)), 
  col = &quot;purple&quot;, lwd = 2)
lines(xAxis, preds$fit, lwd = 3, lty = 2)
</code></pre>

<p>Plot on next slide</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-38" style="background:;">
  <article data-timings="">
    <p><img src="assets/fig/diffRegFits2-1.png" alt="plot of chunk diffRegFits2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-39" style="background:;">
  <hgroup>
    <h2>Add a legend</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">legend(&quot;bottomright&quot;, 
  c(paste(&quot;Loess Fit&quot;, seq(0.25, 1, 0.25)), &quot;Data Generating Line&quot;),
  lty = c(rep(1, 4), 2),
  lwd = c(rep(2, 4), 3),
  col = c(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;purple&quot;, &quot;black&quot;))
</code></pre>

<p><img src="assets/fig/legend2-1.png" alt="plot of chunk legend2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-40" style="background:;">
  <hgroup>
    <h2>A few more options</h2>
  </hgroup>
  <article data-timings="">
    <p>(there are many, many more)</p>

<pre><code class="r">par(mfrow = c(1, 3))
plot(y ~ x, bty = &quot;n&quot;, las = 1)
plot(y ~ x, bty = &quot;n&quot;, las = 2)
plot(y ~ x, bty = &quot;n&quot;, las = 3)
</code></pre>

<p><img src="assets/fig/ops1-1.png" alt="plot of chunk ops1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-41" style="background:;">
  <hgroup>
    <h2>Other options to consider</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Manually add axes with <code>axis()</code> (surpress with <code>xaxt = &quot;n&quot;</code> or <code>yaxt = &quot;n&quot;</code>)</li>
<li>Manually add title (position exactly where you want) with <code>title()</code></li>
<li>Manipulate margins with <code>mar</code> and <code>oma</code> from within <code>par</code></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-42" style="background:;">
  <hgroup>
    <h2>Quick example with margins</h2>
  </hgroup>
  <article data-timings="">
    <h1>Investigate assumptions of the model</h1>

<pre><code class="r">par(mfrow = c(2, 2))
plot(m1)
</code></pre>

<p><img src="assets/fig/regAssum-1.png" alt="plot of chunk regAssum"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-43" style="background:;">
  <article data-timings="">
    <pre><code class="r">par(mfrow = c(2, 2), oma = rep(3, 4), mar = c(1, 1, 3, 2), bty = &quot;n&quot;)
plot(m1)
</code></pre>

<p><img src="assets/fig/margins1-1.png" alt="plot of chunk margins1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-44" style="background:;">
  <hgroup>
    <h2>Cleaning up our multi-line plot just a bit</h2>
  </hgroup>
  <article data-timings="">
    <h1>Base</h1>

<pre><code class="r">plot(y ~ x, 
  bty = &quot;n&quot;, 
  ylim = c(180, 188), 
  xlim = c(0, 8),
  main = &quot;Simulated data example&quot;,
  xlab = &quot;Predictor&quot;,
  ylab = &quot;Outcome&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-45" style="background:;">
  <hgroup>
    <h1>Add Lines</h1>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">lines(xAxis, predict(lfit025, newdata = data.frame(x = xAxis)), 
  col = &quot;red&quot;, lwd = 2)
lines(xAxis, predict(lfit050, newdata = data.frame(x = xAxis)), 
  col = &quot;green&quot;, lwd = 2)
lines(xAxis, predict(lfit075, newdata = data.frame(x = xAxis)), 
  col = &quot;blue&quot;, lwd = 2)
lines(xAxis, predict(lfit100, newdata = data.frame(x = xAxis)), 
  col = &quot;purple&quot;, lwd = 2)
lines(xAxis, preds$fit, lwd = 3, lty = 2)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-46" style="background:;">
  <hgroup>
    <h1>Add Legend</h1>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">legend(&quot;bottomright&quot;, 
  c(paste(&quot;Loess Fit&quot;, seq(0.25, 1, 0.25)), &quot;Data Generating Line&quot;),
  lty = c(rep(1, 4), 2),
  lwd = c(rep(2, 4), 3),
  col = c(&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;, &quot;purple&quot;, &quot;black&quot;),
  box.lty = 0)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-47" style="background:;">
  <hgroup>
    <h1>Final Result</h1>
  </hgroup>
  <article data-timings="">
    <p><img src="assets/fig/finalResult-1.png" alt="plot of chunk finalResult"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-48" style="background:;">
  <hgroup>
    <h2>If we have time...</h2>
  </hgroup>
  <article data-timings="">
    <p>Produce the following plot (the colors can be different, but it should not be 
  black)</p>

<p>Note: The relation is linear so you can use <code>abline</code></p>

<p><img src="assets/fig/regPlotPractice-1.png" alt="plot of chunk regPlotPractice"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-49" style="background:;">
  <hgroup>
    <h2><code>persp</code></h2>
  </hgroup>
  <article data-timings="">
    <p>(I&#39;ll be honest, I don&#39;t use this much. This example is from the documentation.)</p>

<pre><code class="r">x &lt;- seq(-10, 10, length=50)
y &lt;- x
f &lt;- function(x,y) {
    r &lt;- sqrt(x^2+y^2)
    10 * sin(r)/r
}
z &lt;- outer(x, y, f)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-50" style="background:;">
  <article data-timings="">
    <pre><code class="r">persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = &quot;lightblue&quot;,
      xlab = &quot;X&quot;, ylab = &quot;Y&quot;, zlab = &quot;Z&quot;) 
</code></pre>

<p><img src="assets/fig/persp-1.png" alt="plot of chunk persp"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-51" style="background:;">
  <hgroup>
    <h2>image</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">image(x, y, z)
</code></pre>

<p><img src="assets/fig/image1-1.png" alt="plot of chunk image1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-52" style="background:;">
  <hgroup>
    <h2>Volcano data</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">data(volcano)
persp(volcano)
</code></pre>

<p><img src="assets/fig/volcanoPersp-1.png" alt="plot of chunk volcanoPersp"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-53" style="background:;">
  <article data-timings="">
    <pre><code class="r">image(volcano)
</code></pre>

<p><img src="assets/fig/volcanoImage-1.png" alt="plot of chunk volcanoImage"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-54" style="background:;">
  <hgroup>
    <h2>Overlay a density plot on a histogram, maintain frequency y-axis</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="assets/fig/histDensity1-1.png" alt="plot of chunk histDensity1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-55" style="background:;">
  <hgroup>
    <h2>Multi-step process</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>First, plot the histogram, suppressing all axes, labels, and plot border</p>

<pre><code class="r">hist(d$abv, 
  probability = TRUE, 
  axes = FALSE,
  main = &quot;&quot;, 
  xlab = &quot;&quot;, 
  ylab = &quot;&quot;)
</code></pre>

<p><img src="assets/fig/histDensity2-1.png" alt="plot of chunk histDensity2"></p>

</div>
<div style='float:right;width:48%;'>
  <p>Next, use <code>lines</code> to add the density line</p>

<pre><code class="r">lines(density(d$abv), 
  col = &quot;darkgray&quot;, 
  lty = 3, 
  lwd = 3)
</code></pre>

<p><br>
<br></p>

<p><img src="assets/fig/histDensity4-1.png" alt="plot of chunk histDensity4"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-56" style="background:;">
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>Call a new plot to overlay on the current plot</p>

<pre><code class="r">par(new = TRUE)
</code></pre>

<p>Plot the histogram again, labeling the axes how you&#39;d like (note, this process 
  is necessary to keep the frequency y-axis)</p>

<pre><code class="r">hist(d$abv, 
  main = &quot;Distribution of Beer Alcohol 
            by Volume&quot;,
  xlab = &quot;Alcohol by Volume&quot;
  )
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <p><img src="assets/fig/histDensity7-1.png" alt="plot of chunk histDensity7"></p>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-57" style="background:;">
  <hgroup>
    <h2>A few extensions with packages</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><em>beanplot</em> package

<ul>
<li>Similar to violin plots, but better (in my opinion)</li>
</ul></li>
<li><em>visreg</em> package

<ul>
<li>Helpful for visualizing the results of fitted regression models</li>
</ul></li>
<li><em>car</em>

<ul>
<li>Further regression diagnostics</li>
</ul></li>
<li><em>corrplot</em></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-58" style="background:;">
  <hgroup>
    <h2>beanplot</h2>
  </hgroup>
  <article data-timings="">
    <p>From the documentation (second legend is cutoff...)</p>

<pre><code class="r">library(beanplot)
par(mfrow = c(1,2))
boxplot(len ~ dose, data = ToothGrowth,
        boxwex = 0.25, at = 1:3 - 0.2,
        subset = supp == &quot;VC&quot;, col = &quot;yellow&quot;,
        main = &quot;Guinea Pigs  Tooth Growth&quot;,
        xlab = &quot;Vitamin C dose mg&quot;,
        ylab = &quot;tooth length&quot;, ylim = c(-1, 40), yaxs = &quot;i&quot;)
boxplot(len ~ dose, data = ToothGrowth, add = TRUE,
        boxwex = 0.25, at = 1:3 + 0.2,
        subset = supp == &quot;OJ&quot;, col = &quot;orange&quot;)
legend(&quot;bottomright&quot;, bty=&quot;n&quot;,c(&quot;Ascorbic acid&quot;, &quot;Orange juice&quot;),
       fill = c(&quot;yellow&quot;, &quot;orange&quot;))
beanplot(len ~ reorder(supp, len, mean) * dose, ToothGrowth,
        side = &quot;b&quot;, col = list(&quot;yellow&quot;, &quot;orange&quot;), border = c(&quot;yellow2&quot;,
            &quot;darkorange&quot;), main = &quot;Guinea Pigs  Tooth Growth&quot;,
        xlab = &quot;Vitamin C dose mg&quot;, ylab = &quot;tooth length&quot;, ylim = c(-1,
            40), yaxs = &quot;i&quot;)
legend(&quot;bottomright&quot;, bty=&quot;n&quot;,c(&quot;Ascorbic acid&quot;, &quot;Orange juice&quot;),
       fill = c(&quot;yellow&quot;, &quot;orange&quot;))
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-59" style="background:;">
  <article data-timings="">
    <p><img src="assets/fig/beanplot2-1.png" alt="plot of chunk beanplot2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-60" style="background:;">
  <hgroup>
    <h2>Another example</h2>
  </hgroup>
  <article data-timings="">
    <p><img src="../assets/img/ellBeanplot.png" alt="ellBeanplot"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-61" style="background:;">
  <hgroup>
    <h2>visreg</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(visreg)
mod &lt;- lm(score.overall ~ score.by.style + abv, data = d)

par(mfrow = c(1,2))
visreg(mod)
</code></pre>

<p><img src="assets/fig/visreg1-1.png" alt="plot of chunk visreg1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-62" style="background:;">
  <article data-timings="">
    <pre><code class="r">data(airquality)
airquality$Heat &lt;- cut(airquality$Temp, 3, labels=c(&quot;Cool&quot;, &quot;Mild&quot;, &quot;Hot&quot;))

fit.heat &lt;- lm(Ozone ~ Solar.R + Wind + Heat, data = airquality)

par(mfrow = c(1,2))
visreg(fit.heat, &quot;Heat&quot;, type = &quot;contrast&quot;)
visreg(fit.heat, &quot;Heat&quot;, type = &quot;conditional&quot;)
</code></pre>

<p><img src="assets/fig/visreg2-1.png" alt="plot of chunk visreg2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-63" style="background:;">
  <article data-timings="">
    <pre><code class="r">fit &lt;- lm(Ozone ~ Solar.R + Wind + Temp + I(Wind^2) + I(Temp^2) +
    I(Wind*Temp) + I(Wind*Temp^2) + I(Temp*Wind^2) + I(Temp^2*Wind^2),
    data=airquality)

visreg2d(fit,x = &quot;Wind&quot;, y = &quot;Temp&quot;, plot.type = &quot;persp&quot;, 
  col = &quot;cornflowerblue&quot;)
</code></pre>

<p><img src="assets/fig/visreg3-1.png" alt="plot of chunk visreg3"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-64" style="background:;">
  <hgroup>
    <h2>car</h2>
  </hgroup>
  <article data-timings="">
    <p>One example on influential cases</p>

<pre><code class="r">library(car)
fit &lt;- lm(mpg ~ disp + hp + wt + drat, data = mtcars)
influencePlot(fit,  id.method = &quot;identify&quot;, main = &quot;Influence Plot&quot;, 
  sub = &quot;Circle size is proportial to Cook&#39;s Distance&quot; )
</code></pre>

<p><img src="assets/fig/carP1-1.png" alt="plot of chunk carP1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-65" style="background:;">
  <hgroup>
    <h2>Nonlinearity</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">crPlots(fit)
</code></pre>

<p><img src="assets/fig/carNonLinear-1.png" alt="plot of chunk carNonLinear"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-66" style="background:;">
  <hgroup>
    <h2>corrplot</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">simD &lt;- runif(1000)
simD &lt;- (simD*100) + c(1:500, 500:1)
simD &lt;- matrix(simD, ncol=10)
simD &lt;- as.data.frame(simD)
names(simD) &lt;- paste0(&quot;v&quot;, 1:10)
head(simD)
</code></pre>

<pre><code>##         v1       v2       v3       v4       v5       v6       v7       v8
## 1 86.66530 196.7932 249.3985 314.8780 476.3242 574.0706 400.8282 375.1393
## 2 79.47789 167.3020 219.1048 340.9082 462.3343 509.7193 464.0869 329.8782
## 3 86.40271 148.8676 270.5849 329.6046 462.3948 562.2181 403.6566 343.8047
## 4 13.15103 164.6022 230.2990 374.3296 462.2290 539.2184 410.0109 338.4898
## 5 50.95255 133.8722 239.1481 345.7878 428.8659 576.0509 492.0690 328.5016
## 6 65.93982 177.7831 227.0246 332.5564 451.4284 556.6788 420.9572 308.5617
##         v9      v10
## 1 286.5395 152.2450
## 2 203.6396 198.8113
## 3 198.8081 138.2608
## 4 290.9390 155.4302
## 5 220.1662 185.1812
## 6 284.9707 180.3427
</code></pre>

<hr>

<h1>Create correlation matrix</h1>

<pre><code class="r">cors &lt;- cor(simD)
cors
</code></pre>

<pre><code>##             v1         v2         v3         v4         v5         v6
## v1   1.0000000  0.5888353  0.3923158  0.3945793  0.6133795 -0.5105440
## v2   0.5888353  1.0000000  0.5027906  0.5253844  0.5947738 -0.5648113
## v3   0.3923158  0.5027906  1.0000000  0.4964639  0.5016601 -0.5311881
## v4   0.3945793  0.5253844  0.4964639  1.0000000  0.6064481 -0.5407590
## v5   0.6133795  0.5947738  0.5016601  0.6064481  1.0000000 -0.5383980
## v6  -0.5105440 -0.5648113 -0.5311881 -0.5407590 -0.5383980  1.0000000
## v7  -0.4559920 -0.5377671 -0.4905954 -0.5429089 -0.5834340  0.4985944
## v8  -0.3649809 -0.3624990 -0.5039798 -0.4366616 -0.5009528  0.3787914
## v9  -0.4101911 -0.4244067 -0.5388992 -0.3887412 -0.4036375  0.5402136
## v10 -0.5168009 -0.5350476 -0.5451698 -0.5123608 -0.5404701  0.5106893
##             v7         v8         v9        v10
## v1  -0.4559920 -0.3649809 -0.4101911 -0.5168009
## v2  -0.5377671 -0.3624990 -0.4244067 -0.5350476
## v3  -0.4905954 -0.5039798 -0.5388992 -0.5451698
## v4  -0.5429089 -0.4366616 -0.3887412 -0.5123608
## v5  -0.5834340 -0.5009528 -0.4036375 -0.5404701
## v6   0.4985944  0.3787914  0.5402136  0.5106893
## v7   1.0000000  0.3289916  0.3958724  0.5330916
## v8   0.3289916  1.0000000  0.4646024  0.4810632
## v9   0.3958724  0.4646024  1.0000000  0.3620270
## v10  0.5330916  0.4810632  0.3620270  1.0000000
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-67" style="background:;">
  <hgroup>
    <h1>plot cor matrix</h1>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(corrplot)
corrplot(cors, type = &quot;lower&quot;)
</code></pre>

<p><img src="assets/fig/corrplot1-1.png" alt="plot of chunk corrplot1"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-68" style="background:;">
  <article data-timings="">
    <pre><code class="r">library(corrplot)
corrplot(cors, type = &quot;upper&quot;, addCoef.col=&quot;black&quot;)
</code></pre>

<p><img src="assets/fig/corrplot2-1.png" alt="plot of chunk corrplot2"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-69" style="background:;">
  <article data-timings="">
    <pre><code class="r">library(corrplot)
corrplot(cors, type = &quot;upper&quot;, method = &quot;square&quot;)
</code></pre>

<p><img src="assets/fig/corrplot3-1.png" alt="plot of chunk corrplot3"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-70" style="background:;">
  <hgroup>
    <h2>Analysis-specific plotting</h2>
  </hgroup>
  <article data-timings="">
    <p>Example with multilevel modeling</p>

<pre><code class="r">data(Orthodont,package=&quot;nlme&quot;)
library(lme4)
fm1 &lt;- lmer(distance ~ age + (age|Subject), data=Orthodont)

## observed versus fitted values by Subject
plot(fm1, distance ~ fitted(.) | Subject, abline = c(0,1))
</code></pre>

<p><img src="assets/fig/lme4Plot-1.png" alt="plot of chunk lme4Plot"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-71" style="background:;">
  <hgroup>
    <h2>Practice (and then break)</h2>
  </hgroup>
  <article data-timings="">
    <p>First, produce the following plots. Again, the colors, line types, etc., can
  be different, but they should not be the default (where the defaults have been changed).</p>

<p>Next, fit a few regression models, and play around with the <em>visreg</em> package.</p>

<p><img src="assets/fig/plotPractice-1.png" alt="plot of chunk plotPractice"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='NA'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='Data: Beer!'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Load data'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Histograms'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='Look at the documentation'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='Change the number of break points'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='Alternative: Plot a table of frequencies'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='Smooth the distribution'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='Density binwidth'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='Your turn'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='Scatter plots and controlling lines, colors, axes, etc.'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='The <code>plot()</code> function'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='Plot types'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Scatter plots'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='Additional arguments'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Examples: Beer style and overall ratings'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='Change point type, color, and size'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Colors in R'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Some helpful packages'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='Point Types'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='Line types'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='Custom line types'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='Add horizontal and vertical reference lines at the mean'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='NA'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='Quick aside: Fitting linear regression models in R'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='Formula structure'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='Modeling the relation between beer style rating and the overall rating'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='Alternative summary'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='Extensions'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='Plot the relation and the model'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='A note on <code>abline</code>'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='Fit a nonlinear model'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='Fit the model'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='Overlay the regression line'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='Include the SE'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='NA'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='Plot a few different fits'>
         37
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=38 title='NA'>
         38
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=39 title='Add a legend'>
         39
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=40 title='A few more options'>
         40
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=41 title='Other options to consider'>
         41
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=42 title='Quick example with margins'>
         42
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=43 title='NA'>
         43
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=44 title='Cleaning up our multi-line plot just a bit'>
         44
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=45 title='Add Lines'>
         45
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=46 title='Add Legend'>
         46
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=47 title='Final Result'>
         47
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=48 title='If we have time...'>
         48
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=49 title='<code>persp</code>'>
         49
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=50 title='NA'>
         50
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=51 title='image'>
         51
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=52 title='Volcano data'>
         52
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=53 title='NA'>
         53
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=54 title='Overlay a density plot on a histogram, maintain frequency y-axis'>
         54
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=55 title='Multi-step process'>
         55
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=56 title='NA'>
         56
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=57 title='A few extensions with packages'>
         57
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=58 title='beanplot'>
         58
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=59 title='NA'>
         59
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=60 title='Another example'>
         60
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=61 title='visreg'>
         61
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=62 title='NA'>
         62
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=63 title='NA'>
         63
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=64 title='car'>
         64
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=65 title='Nonlinearity'>
         65
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=66 title='corrplot'>
         66
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=67 title='plot cor matrix'>
         67
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=68 title='NA'>
         68
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=69 title='NA'>
         69
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=70 title='Analysis-specific plotting'>
         70
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=71 title='Practice (and then break)'>
         71
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>